# Stefan Achatz 2014
#
# Tries to find libgaminggear and sets following variables according to found capabilities:
#
# GAMINGGEAR@V_MAJOR@_FOUND
# GAMINGGEAR@V_MAJOR@_INCLUDE_DIR
# GAMINGGEAR@V_MAJOR@_LIBRARY
# GAMINGGEAR@V_MAJOR@_WIDGET_LIBRARY
# GAMINGGEAR@V_MAJOR@_VERSION
# GAMINGGEAR@V_MAJOR@_FX_PLUGIN_DIR

FIND_PACKAGE(PkgConfig)
PKG_CHECK_MODULES(PKG_GAMINGGEAR gaminggear-@V_MAJOR@)

FIND_PATH(GAMINGGEAR@V_MAJOR@_INCLUDE_DIR gaminggear/gaminggear.h
  HINTS
    ${PKG_GAMINGGEAR_INCLUDEDIR}
)

FIND_LIBRARY(GAMINGGEAR@V_MAJOR@_LIBRARY gaminggear
  HINTS ${PKG_GAMINGGEAR_LIBRARY_DIRS}
)

FIND_LIBRARY(GAMINGGEAR@V_MAJOR@_WIDGET_LIBRARY gaminggearwidget
  HINTS ${PKG_GAMINGGEAR_LIBRARY_DIRS}
)

SET(GAMINGGEAR@V_MAJOR@_FX_PLUGIN_DIR @GFX_PLUGIN_DIR@)

IF(GAMINGGEAR@V_MAJOR@_LIBRARY AND GAMINGGEAR@V_MAJOR@_WIDGET_LIBRARY AND GAMINGGEAR@V_MAJOR@_INCLUDE_DIR)
  FILE(READ "${GAMINGGEAR@V_MAJOR@_INCLUDE_DIR}/gaminggear/gaminggear.h" _CONTENTS)
  IF(_CONTENTS)
    STRING(REGEX REPLACE ".*#define[ \t]+GAMINGGEAR_VERSION_STRING[ \t]+\"([0-9.]+)\".*" "\\1" GAMINGGEAR@V_MAJOR@_VERSION "${_CONTENTS}")
  ELSE()
    MESSAGE(FATAL_ERROR "Can't read ${GAMINGGEAR@V_MAJOR@_INCLUDE_DIR}/gaminggear/gaminggear.h")
  ENDIF()

  IF(GAMINGGEAR@V_MAJOR@_FIND_VERSION)
    IF(GAMINGGEAR@V_MAJOR@_FIND_VERSION_EXACT)
      IF(GAMINGGEAR@V_MAJOR@_VERSION VERSION_EQUAL GAMINGGEAR@V_MAJOR@_FIND_VERSION)
        SET(GAMINGGEAR@V_MAJOR@_FOUND true)
      ELSE()
        SET(GAMINGGEAR@V_MAJOR@_FOUND false)
        MESSAGE("GAMINGGEAR@V_MAJOR@ version mismatch ${GAMINGGEAR@V_MAJOR@_VERSION} != ${GAMINGGEAR@V_MAJOR@_FIND_VERSION}")
      ENDIF()
    ELSE()
      IF(GAMINGGEAR@V_MAJOR@_VERSION VERSION_EQUAL GAMINGGEAR@V_MAJOR@_FIND_VERSION OR
         GAMINGGEAR@V_MAJOR@_VERSION VERSION_GREATER GAMINGGEAR@V_MAJOR@_FIND_VERSION)
        SET(GAMINGGEAR@V_MAJOR@_FOUND true)
      ELSE()
        SET(GAMINGGEAR@V_MAJOR@_FOUND false)
        MESSAGE("GAMINGGEAR@V_MAJOR@ version mismatch ${GAMINGGEAR@V_MAJOR@_VERSION} < ${GAMINGGEAR@V_MAJOR@_FIND_VERSION}")
      ENDIF()
    ENDIF()
  ELSE()
    SET(GAMINGGEAR@V_MAJOR@_FOUND true)
  ENDIF()
ENDIF()

IF(NOT GAMINGGEAR@V_MAJOR@_FOUND)
  UNSET(GAMINGGEAR@V_MAJOR@_INCLUDE_DIR)
  UNSET(GAMINGGEAR@V_MAJOR@_LIBRARY)
  UNSET(GAMINGGEAR@V_MAJOR@_WIDGET_LIBRARY)
  UNSET(GAMINGGEAR@V_MAJOR@_VERSION)
  UNSET(GAMINGGEAR@V_MAJOR@_FX_PLUGIN_DIR)
ENDIF()

IF(GAMINGGEAR@V_MAJOR@_FIND_REQUIRED AND NOT GAMINGGEAR@V_MAJOR@_FOUND)
  MESSAGE(FATAL_ERROR "Could not find GAMINGGEAR@V_MAJOR@")
ENDIF()
